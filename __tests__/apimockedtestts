import { postCustomer } from 'services/client/post'
import { tokenForTest } from 'lib/utils'
import { Customer } from '@prisma/client'
jest.mock('node-fetch')
const { Response } = jest.requireActual('node-fetch')

describe('API Mocked', () => {
  const _username = 'casa2'
  const _customer: Customer = {
    id: 7,
    userId: '',
    username: _username,
  }

  it('postCustomer', async () => {
    // eslint-disable-next-line @typescript-eslint/ban-ts-comment
    //@ts-ignore
    fetch.mockReturnValue(Promise.resolve(new Response(JSON.stringify(_customer))))

    const customer = await postCustomer(_customer, tokenForTest)

    expect(customer?.username ?? '').toBe(_username)
  })
})
